<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ë¦¬ ê°€ì¡± ì‚¬ì´íŠ¸ - ì™„ì „íŒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .main-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        header {
            background: #667eea;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #ddd;
        }

        .nav-btn {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }

        .nav-btn:hover {
            background: #e9ecef;
        }

        .nav-btn.active {
            background: #667eea;
            color: white;
        }

        .section {
            display: none;
            padding: 20px;
        }

        .section.active {
            display: block;
        }

        /* ë¡œê·¸ì¸ ìŠ¤íƒ€ì¼ */
        .auth-section {
            text-align: center;
            padding: 40px;
        }

        .auth-form {
            max-width: 400px;
            margin: 0 auto;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
        }

        .auth-form input {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .auth-form button {
            width: 100%;
            padding: 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }

        /* ì±„íŒ… ìŠ¤íƒ€ì¼ */
        .chat-container {
            height: 500px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            overflow-y: auto;
            background: #f8f9fa;
            margin-bottom: 15px;
        }

        .message {
            margin-bottom: 10px;
            padding: 8px 12px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            animation: fadeIn 0.3s ease-in;
        }

        .message.own {
            background: #667eea;
            color: white;
            margin-left: 20%;
        }

        .message .username {
            font-weight: bold;
            color: #667eea;
            margin-right: 8px;
        }

        .message.own .username {
            color: #fff;
        }

        .message .timestamp {
            font-size: 12px;
            color: #666;
            float: right;
        }

        .message.own .timestamp {
            color: #ddd;
        }

        .message img {
            max-width: 200px;
            max-height: 200px;
            border-radius: 8px;
            margin-top: 5px;
        }

        .chat-input {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .chat-input input[type="text"] {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .chat-input input[type="file"] {
            display: none;
        }

        .file-btn, .chat-input button {
            padding: 10px 15px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .file-btn {
            background: #28a745;
        }

        /* ê²Œì„ ìŠ¤íƒ€ì¼ */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .game-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .game-card:hover {
            transform: translateY(-5px);
        }

        .game-card .icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .play-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }

        .play-btn:hover {
            background: #5a6fd8;
        }

        /* ë¶€ë£¨ë§ˆë¸” ê²Œì„ ìŠ¤íƒ€ì¼ */
        .board-game {
            max-width: 600px;
            margin: 0 auto;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 2px;
            background: #333;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .board-cell {
            background: #fff;
            padding: 8px;
            text-align: center;
            font-size: 12px;
            min-height: 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            border-radius: 4px;
        }

        .board-cell.corner {
            background: #ffd700;
            font-weight: bold;
        }

        .board-cell.property {
            background: #87ceeb;
        }

        .board-cell.special {
            background: #ffa500;
        }

        .player {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .player.player1 { background: #ff4757; }
        .player.player2 { background: #2ed573; }
        .player.player3 { background: #3742fa; }
        .player.player4 { background: #ffa502; }

        .game-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .dice {
            width: 50px;
            height: 50px;
            background: white;
            border: 2px solid #333;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            margin: 0 10px;
        }

        .game-info {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .player-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 5px 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .current-player {
            background: #667eea;
            color: white;
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 80%;
            max-height: 80%;
            overflow-y: auto;
            position: relative;
        }

        .close {
            position: absolute;
            right: 15px;
            top: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #aaa;
        }

        .close:hover {
            color: #000;
        }

        .hidden {
            display: none;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        #logoutBtn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .bounce {
            animation: bounce 1s;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .game-board {
                grid-template-columns: repeat(6, 1fr);
            }
            
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .chat-container {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-container">
            <!-- ë¡œê·¸ì¸ í™”ë©´ -->
            <div id="auth-container">
                <div class="auth-section">
                    <h1>ğŸ  ìš°ë¦¬ ê°€ì¡± ì‚¬ì´íŠ¸</h1>
                    <p style="margin-bottom: 30px;">ì±„íŒ…, ê²Œì„, ì‚¬ì§„ ê³µìœ ê°€ ê°€ëŠ¥í•œ ì™„ì „íŒ!</p>
                    
                    <div class="auth-form">
                        <h2>ê°€ì¡± ì…ì¥</h2>
                        <input type="text" id="username" placeholder="ì‚¬ìš©ìëª… ì…ë ¥ (ì˜ˆ: ì—„ë§ˆ, ì•„ë¹ , ë”¸, ì•„ë“¤)">
                        <input type="text" id="familyCode" placeholder="ê°€ì¡± ì½”ë“œ ì…ë ¥ (ì˜ˆ: kim2024)">
                        <button onclick="login()">ì…ì¥í•˜ê¸°</button>
                        <p style="margin-top: 15px; font-size: 14px; color: #666;">
                            * ê°™ì€ ê°€ì¡± ì½”ë“œë¥¼ ì‚¬ìš©í•˜ë©´ í•¨ê»˜ ì±„íŒ…í•˜ê³  ê²Œì„í•  ìˆ˜ ìˆì–´ìš”!
                        </p>
                    </div>
                </div>
            </div>

            <!-- ë©”ì¸ í™”ë©´ -->
            <div id="main-container" class="hidden">
                <header>
                    <h1>ğŸ  ìš°ë¦¬ ê°€ì¡±</h1>
                    <div class="user-info">
                        <span id="welcomeMessage"></span>
                        <span id="onlineCount">ì˜¨ë¼ì¸: 1ëª…</span>
                        <button id="logoutBtn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
                    </div>
                </header>

                <div class="nav">
                    <button class="nav-btn active" onclick="showSection('chat')">ğŸ’¬ ì±„íŒ…</button>
                    <button class="nav-btn" onclick="showSection('games')">ğŸ® ê²Œì„</button>
                    <button class="nav-btn" onclick="showSection('photos')">ğŸ“· ì‚¬ì§„</button>
                    <button class="nav-btn" onclick="showSection('board')">ğŸ² ë³´ë“œê²Œì„</button>
                </div>

                <!-- ì±„íŒ… ì„¹ì…˜ -->
                <div id="chat-section" class="section active">
                    <h2>ğŸ’¬ ê°€ì¡± ì±„íŒ…</h2>
                    <div class="chat-container">
                        <div id="chatMessages" class="chat-messages">
                            <div class="message">
                                <span class="username">ğŸ¤– ì‹œìŠ¤í…œ:</span>
                                <span>ê°€ì¡± ì±„íŒ…ë°©ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‰</span>
                                <span class="timestamp">${new Date().toLocaleTimeString()}</span>
                            </div>
                        </div>
                        <div class="chat-input">
                            <input type="text" id="messageInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="handleEnter(event)">
                            <label for="imageInput" class="file-btn">ğŸ“·</label>
                            <input type="file" id="imageInput" accept="image/*" onchange="handleImageUpload(event)">
                            <button onclick="sendMessage()">ì „ì†¡</button>
                        </div>
                    </div>
                </div>

                <!-- ê²Œì„ ì„¹ì…˜ -->
                <div id="games-section" class="section">
                    <h2>ğŸ® ê°€ì¡± ê²Œì„</h2>
                    <div class="games-grid">
                        <div class="game-card">
                            <div class="icon">ğŸ§ </div>
                            <h3>ê°€ì¡± í€´ì¦ˆ</h3>
                            <p>ê°€ì¡±ì— ëŒ€í•œ ì¬ë¯¸ìˆëŠ” í€´ì¦ˆë¥¼ í’€ì–´ë³´ì„¸ìš”!</p>
                            <button class="play-btn" onclick="startQuiz()">ê²Œì„ ì‹œì‘</button>
                        </div>
                        <div class="game-card">
                            <div class="icon">ğŸ²</div>
                            <h3>ìˆ«ì ë§ì¶”ê¸°</h3>
                            <p>1-100 ì‚¬ì´ì˜ ìˆ«ìë¥¼ ë§ì¶°ë³´ì„¸ìš”!</p>
                            <button class="play-btn" onclick="startNumberGame()">ê²Œì„ ì‹œì‘</button>
                        </div>
                        <div class="game-card">
                            <div class="icon">ğŸƒ</div>
                            <h3>ê¸°ì–µë ¥ ê²Œì„</h3>
                            <p>ì¹´ë“œë¥¼ ë’¤ì§‘ì–´ì„œ ê°™ì€ ê·¸ë¦¼ì„ ì°¾ì•„ë³´ì„¸ìš”!</p>
                            <button class="play-btn" onclick="startMemoryGame()">ê²Œì„ ì‹œì‘</button>
                        </div>
                        <div class="game-card">
                            <div class="icon">ğŸ¨</div>
                            <h3>ê·¸ë¦¼ ë§ì¶”ê¸°</h3>
                            <p>ë‹¨ì–´ë¥¼ ë³´ê³  ê·¸ë¦¼ì„ ê·¸ë ¤ë³´ì„¸ìš”!</p>
                            <button class="play-btn" onclick="startDrawingGame()">ê²Œì„ ì‹œì‘</button>
                        </div>
                        <div class="game-card">
                            <div class="icon">ğŸ¯</div>
                            <h3>ë¹™ê³  ê²Œì„</h3>
                            <p>ê°€ì¡±ê³¼ í•¨ê»˜ ë¹™ê³ ë¥¼ ì™„ì„±í•´ë³´ì„¸ìš”!</p>
                            <button class="play-btn" onclick="startBingoGame()">ê²Œì„ ì‹œì‘</button>
                        </div>
                        <div class="game-card">
                            <div class="icon">ğŸª</div>
                            <h3>ë£°ë › ê²Œì„</h3>
                            <p>ë£°ë ›ì„ ëŒë ¤ì„œ ì¬ë¯¸ìˆëŠ” ë¯¸ì…˜ì„ ë°›ì•„ë³´ì„¸ìš”!</p>
                            <button class="play-btn" onclick="startRouletteGame()">ê²Œì„ ì‹œì‘</button>
                        </div>
                    </div>
                </div>

                <!-- ì‚¬ì§„ ì„¹ì…˜ -->
                <div id="photos-section" class="section">
                    <h2>ğŸ“· ê°€ì¡± ì‚¬ì§„</h2>
                    <div style="text-align: center; margin-bottom: 20px;">
                        <input type="file" id="photoUpload" accept="image/*" multiple style="display: none;" onchange="handlePhotoUpload(event)">
                        <button class="play-btn" onclick="document.getElementById('photoUpload').click()">ğŸ“· ì‚¬ì§„ ì—…ë¡œë“œ</button>
                    </div>
                    <div id="photoGallery" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
                        <!-- ì‚¬ì§„ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <!-- ë³´ë“œê²Œì„ ì„¹ì…˜ -->
                <div id="board-section" class="section">
                    <h2>ğŸ² ê°€ì¡± ë¶€ë£¨ë§ˆë¸”</h2>
                    <div class="board-game">
                        <div class="game-controls">
                            <button class="play-btn" onclick="rollDice()" id="rollBtn">ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</button>
                            <div class="dice" id="dice1">1</div>
                            <div class="dice" id="dice2">1</div>
                            <button class="play-btn" onclick="resetGame()">ê²Œì„ ë¦¬ì…‹</button>
                        </div>
                        
                        <div class="game-board" id="gameBoard">
                            <!-- ë³´ë“œ ì¹¸ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                        
                        <div class="game-info">
                            <div id="currentPlayerInfo">í˜„ì¬ ì°¨ë¡€: <span id="currentPlayerName">í”Œë ˆì´ì–´ 1</span></div>
                            <div id="playersInfo">
                                <!-- í”Œë ˆì´ì–´ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê²Œì„ ëª¨ë‹¬ -->
        <div id="gameModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal()">&times;</span>
                <div id="gameContent">
                    <!-- ê²Œì„ ë‚´ìš©ì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentUser = null;
        let messages = [];
        let photos = [];
        let onlineUsers = [];
        
        // ë¶€ë£¨ë§ˆë¸” ê²Œì„ ë³€ìˆ˜
        let boardGame = {
            players: [
                { name: 'í”Œë ˆì´ì–´ 1', position: 0, money: 1000, color: 'player1' },
                { name: 'í”Œë ˆì´ì–´ 2', position: 0, money: 1000, color: 'player2' },
                { name: 'í”Œë ˆì´ì–´ 3', position: 0, money: 1000, color: 'player3' },
                { name: 'í”Œë ˆì´ì–´ 4', position: 0, money: 1000, color: 'player4' }
            ],
            currentPlayer: 0,
            boardCells: [
                { name: 'ì‹œì‘', type: 'corner', color: '#ffd700' },
                { name: 'ì„œìš¸', type: 'property', price: 100, color: '#87ceeb' },
                { name: 'ê¸°íšŒ', type: 'special', color: '#ffa500' },
                { name: 'ë¶€ì‚°', type: 'property', price: 120, color: '#87ceeb' },
                { name: 'ì„¸ê¸ˆ', type: 'special', color: '#ffa500' },
                { name: 'ëŒ€êµ¬', type: 'property', price: 140, color: '#87ceeb' },
                { name: 'ê°ì˜¥', type: 'corner', color: '#ffd700' },
                { name: 'ì¸ì²œ', type: 'property', price: 160, color: '#87ceeb' },
                { name: 'ê¸°íšŒ', type: 'special', color: '#ffa500' },
                { name: 'ê´‘ì£¼', type: 'property', price: 180, color: '#87ceeb' },
                { name: 'ì„¸ê¸ˆ', type: 'special', color: '#ffa500' },
                { name: 'ëŒ€ì „', type: 'property', price: 200, color: '#87ceeb' },
                { name: 'íœ´ì‹', type: 'corner', color: '#ffd700' },
                { name: 'ìš¸ì‚°', type: 'property', price: 220, color: '#87ceeb' },
                { name: 'ê¸°íšŒ', type: 'special', color: '#ffa500' },
                { name: 'ì œì£¼', type: 'property', price: 300, color: '#87ceeb' }
            ]
        };

        // ë¡œê·¸ì¸ í•¨ìˆ˜
        function login() {
            const username = document.getElementById('username').value.trim();
            const familyCode = document.getElementById('familyCode').value.trim();
            
            if (!username || !familyCode) {
                alert('ì‚¬ìš©ìëª…ê³¼ ê°€ì¡± ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            currentUser = { username, familyCode, joinTime: new Date() };
            localStorage.setItem('familySiteUser', JSON.stringify(currentUser));
            
            // ì˜¨ë¼ì¸ ì‚¬ìš©ì ëª©ë¡ì— ì¶”ê°€
            addOnlineUser(currentUser);
            
            document.getElementById('auth-container').classList.add('hidden');
            document.getElementById('main-container').classList.remove('hidden');
            document.getElementById('welcomeMessage').textContent = `ì•ˆë…•í•˜ì„¸ìš”, ${username}ë‹˜!`;
            
            loadMessages();
            loadPhotos();
            initBoardGame();
            
            // ì…ì¥ ë©”ì‹œì§€ ì¶”ê°€
            addSystemMessage(`${username}ë‹˜ì´ ì…ì¥í•˜ì…¨ìŠµë‹ˆë‹¤! ğŸ‘‹`);
        }

        // ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
        function logout() {
            if (currentUser) {
                addSystemMessage(`${currentUser.username}ë‹˜ì´ í‡´ì¥í•˜ì…¨ìŠµë‹ˆë‹¤! ğŸ‘‹`);
                removeOnlineUser(currentUser);
            }
            
            currentUser = null;
            localStorage.removeItem('familySiteUser');
            document.getElementById('auth-container').classList.remove('hidden');
            document.getElementById('main-container').classList.add('hidden');
            document.getElementById('username').value = '';
            document.getElementById('familyCode').value = '';
        }

        // ì˜¨ë¼ì¸ ì‚¬ìš©ì ê´€ë¦¬
        function addOnlineUser(user) {
            const savedUsers = JSON.parse(localStorage.getItem('onlineUsers') || '[]');
            const existingIndex = savedUsers.findIndex(u => u.username === user.username && u.familyCode === user.familyCode);
            
            if (existingIndex === -1) {
                savedUsers.push(user);
            } else {
                savedUsers[existingIndex] = user;
            }
            
            localStorage.setItem('onlineUsers', JSON.stringify(savedUsers));
            updateOnlineCount();
        }

        function removeOnlineUser(user) {
            const savedUsers = JSON.parse(localStorage.getItem('onlineUsers') || '[]');
            const filteredUsers = savedUsers.filter(u => !(u.username === user.username && u.familyCode === user.familyCode));
            localStorage.setItem('onlineUsers', JSON.stringify(filteredUsers));
            updateOnlineCount();
        }

        function updateOnlineCount() {
            const savedUsers = JSON.parse(localStorage.getItem('onlineUsers') || '[]');
            const familyUsers = savedUsers.filter(u => u.familyCode === currentUser?.familyCode);
            document.getElementById('onlineCount').textContent = `ì˜¨ë¼ì¸: ${familyUsers.length}ëª…`;
        }

        // ì„¹ì…˜ ì „í™˜
        function showSection(sectionName) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`${sectionName}-section`).classList.add('active');
            event.target.classList.add('active');
        }

        // ì±„íŒ… ê¸°ëŠ¥
        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (!message || !currentUser) return;
            
            const newMessage = {
                username: currentUser.username,
                message: message,
                timestamp: new Date(),
                familyCode: currentUser.familyCode,
                type: 'text'
            };
            
            messages.push(newMessage);
            localStorage.setItem('familySiteMessages', JSON.stringify(messages));
            
            displayMessage(newMessage);
            messageInput.value = '';
        }

        function displayMessage(messageData) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            if (messageData.username === currentUser?.username) {
                messageDiv.classList.add('own');
            }
            
            const timestamp = new Date(messageData.timestamp).toLocaleTimeString('ko-KR', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            let content = '';
            if (messageData.type === 'image') {
                content = `<img src="${messageData.message}" alt="ì—…ë¡œë“œëœ ì´ë¯¸ì§€" onclick="openImageModal('${messageData.message}')">`;
            } else {
                content = messageData.message;
            }
            
            messageDiv.innerHTML = `
                <span class="username">${messageData.username}:</span>
                <div>${content}</div>
                <span class="timestamp">${timestamp}</span>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
            messageDiv.classList.add('bounce');
        }

        function addSystemMessage(message) {
            const systemMessage = {
                username: 'ğŸ¤– ì‹œìŠ¤í…œ',
                message: message,
                timestamp: new Date(),
                familyCode: currentUser?.familyCode || 'system',
                type: 'system'
            };
            
            messages.push(systemMessage);
            localStorage.setItem('familySiteMessages', JSON.stringify(messages));
            displayMessage(systemMessage);
        }

        function loadMessages() {
            const savedMessages = localStorage.getItem('familySiteMessages');
            if (savedMessages) {
                messages = JSON.parse(savedMessages);
                const familyMessages = messages.filter(m => m.familyCode === currentUser.familyCode);
                
                const chatMessages = document.getElementById('chatMessages');
                chatMessages.innerHTML = '';
                
                familyMessages.slice(-50).forEach(displayMessage); // ìµœê·¼ 50ê°œ ë©”ì‹œì§€ë§Œ í‘œì‹œ
            }
        }

        // ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const imageData = e.target.result;
                
                const newMessage = {
                    username: currentUser.username,
                    message: imageData,
                    timestamp: new Date(),
                    familyCode: currentUser.familyCode,
                    type: 'image'
                };
                
                messages.push(newMessage);
                localStorage.setItem('familySiteMessages', JSON.stringify(messages));
                displayMessage(newMessage);
            };
            
            reader.readAsDataURL(file);
            event.target.value = ''; // íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™”
        }

        // ì‚¬ì§„ ê°¤ëŸ¬ë¦¬ ê¸°ëŠ¥
        function handlePhotoUpload(event) {
            const files = Array.from(event.target.files);
            
            files.forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const photoData = {
                        src: e.target.result,
                        name: file.name,
                        uploadTime: new Date(),
                        uploader: currentUser.username,
                        familyCode: currentUser.familyCode
                    };
                    
                    photos.push(photoData);
                    localStorage.setItem('familySitePhotos', JSON.stringify(photos));
                    displayPhoto(photoData);
                    
                    addSystemMessage(`${currentUser.username}ë‹˜ì´ ì‚¬ì§„ì„ ì—…ë¡œë“œí–ˆìŠµë‹ˆë‹¤! ğŸ“·`);
                };
                reader.readAsDataURL(file);
            });
            
            event.target.value = '';
        }

        function displayPhoto(photoData) {
            const gallery = document.getElementById('photoGallery');
            const photoDiv = document.createElement('div');
            photoDiv.style.cssText = `
                background: white;
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                transition: transform 0.3s;
            `;
            
            photoDiv.innerHTML = `
                <img src="${photoData.src}" alt="${photoData.name}" 
                     style="width: 100%; height: 150px; object-fit: cover; cursor: pointer;"
                     onclick="openImageModal('${photoData.src}')">
                <div style="padding: 10px;">
                    <div style="font-size: 12px; color: #666;">${photoData.uploader}</div>
                    <div style="font-size: 10px; color: #999;">${new Date(photoData.uploadTime).toLocaleDateString()}</div>
                </div>
            `;
            
            photoDiv.addEventListener('mouseenter', () => {
                photoDiv.style.transform = 'translateY(-5px)';
            });
            
            photoDiv.addEventListener('mouseleave', () => {
                photoDiv.style.transform = 'translateY(0)';
            });
            
            gallery.appendChild(photoDiv);
        }

        function loadPhotos() {
            const savedPhotos = localStorage.getItem('familySitePhotos');
            if (savedPhotos) {
                photos = JSON.parse(savedPhotos);
                const familyPhotos = photos.filter(p => p.familyCode === currentUser.familyCode);
                
                const gallery = document.getElementById('photoGallery');
                gallery.innerHTML = '';
                
                familyPhotos.forEach(displayPhoto);
            }
        }

        // ì´ë¯¸ì§€ ëª¨ë‹¬
        function openImageModal(imageSrc) {
            const modal = document.getElementById('gameModal');
            const content = document.getElementById('gameContent');
            
            content.innerHTML = `
                <h3>ì´ë¯¸ì§€ ë³´ê¸°</h3>
                <img src="${imageSrc}" style="max-width: 100%; max-height: 70vh; border-radius: 8px;">
                <div style="text-align: center; margin-top: 20px;">
                    <button class="play-btn" onclick="closeModal()">ë‹«ê¸°</button>
                </div>
            `;
            
            modal.classList.add('show');
        }

        // Enter í‚¤ ì²˜ë¦¬
        function handleEnter(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // ë¶€ë£¨ë§ˆë¸” ê²Œì„ ì´ˆê¸°í™”
        function initBoardGame() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            
            boardGame.boardCells.forEach((cell, index) => {
                const cellDiv = document.createElement('div');
                cellDiv.className = `board-cell ${cell.type}`;
                cellDiv.innerHTML = `
                    <div style="font-weight: bold; font-size: 10px;">${cell.name}</div>
                    ${cell.price ? `<div style="font-size: 8px;">$${cell.price}</div>` : ''}
                `;
                cellDiv.id = `cell-${index}`;
                board.appendChild(cellDiv);
            });
            
            updatePlayerPositions();
            updatePlayerInfo();
        }

        function rollDice() {
            const dice1 = Math.floor(Math.random() * 6) + 1;
            const dice2 = Math.floor(Math.random() * 6) + 1;
            const total = dice1 + dice2;
            
            document.getElementById('dice1').textContent = dice1;
            document.getElementById('dice2').textContent = dice2;
            
            // ì£¼ì‚¬ìœ„ ì• ë‹ˆë©”ì´ì…˜
            document.getElementById('dice1').classList.add('bounce');
            document.getElementById('dice2').classList.add('bounce');
            
            setTimeout(() => {
                document.getElementById('dice1').classList.remove('bounce');
                document.getElementById('dice2').classList.remove('bounce');
            }, 1000);
            
            // í”Œë ˆì´ì–´ ì´ë™
            const currentPlayer = boardGame.players[boardGame.currentPlayer];
            currentPlayer.position = (currentPlayer.position + total) % boardGame.boardCells.length;
            
            updatePlayerPositions();
            
            // ì¹¸ íš¨ê³¼ ì²˜ë¦¬
            const currentCell = boardGame.boardCells[currentPlayer.position];
            handleCellEffect(currentPlayer, currentCell);
            
            // ë‹¤ìŒ í”Œë ˆì´ì–´ë¡œ í„´ ë³€ê²½
            boardGame.currentPlayer = (boardGame.currentPlayer + 1) % boardGame.players.length;
            updatePlayerInfo();
            
            addSystemMessage(`ğŸ² ${currentPlayer.name}ì´(ê°€) ${dice1}, ${dice2} (ì´ ${total})ì„ êµ´ë ¤ì„œ ${currentCell.name}ì— ë„ì°©í–ˆìŠµë‹ˆë‹¤!`);
        }

        function updatePlayerPositions() {
            // ëª¨ë“  í”Œë ˆì´ì–´ ì œê±°
            document.querySelectorAll('.player').forEach(p => p.remove());
            
            // í”Œë ˆì´ì–´ ë‹¤ì‹œ ë°°ì¹˜
            boardGame.players.forEach((player, index) => {
                const cell = document.getElementById(`cell-${player.position}`);
                const playerDiv = document.createElement('div');
                playerDiv.className = `player ${player.color}`;
                playerDiv.textContent = index + 1;
                playerDiv.style.left = `${(index % 2) * 25}px`;
                playerDiv.style.top = `${Math.floor(index / 2) * 25}px`;
                cell.appendChild(playerDiv);
            });
        }

        function updatePlayerInfo() {
            const playersInfo = document.getElementById('playersInfo');
            const currentPlayerName = document.getElementById('currentPlayerName');
            
            currentPlayerName.textContent = boardGame.players[boardGame.currentPlayer].name;
            
            playersInfo.innerHTML = '';
            boardGame.players.forEach((player, index) => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-info';
                if (index === boardGame.currentPlayer) {
                    playerDiv.classList.add('current-player');
                }
                
                playerDiv.innerHTML = `
                    <span>${player.name}</span>
                    <span>$${player.money}</span>
                `;
                playersInfo.appendChild(playerDiv);
            });
        }

        function handleCellEffect(player, cell) {
            switch (cell.type) {
                case 'property':
                    if (Math.random() > 0.5) {
                        player.money -= cell.price;
                        addSystemMessage(`ğŸ’° ${player.name}ì´(ê°€) ${cell.name}ì„(ë¥¼) êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤! (-$${cell.price})`);
                    }
                    break;
                case 'special':
                    const effect = Math.random() > 0.5 ? 100 : -50;
                    player.money += effect;
                    const message = effect > 0 ? `ğŸ‰ ${player.name}ì´(ê°€) $${effect}ì„ ë°›ì•˜ìŠµë‹ˆë‹¤!` : `ğŸ˜… ${player.name}ì´(ê°€) $${Math.abs(effect)}ì„ ìƒì—ˆìŠµë‹ˆë‹¤!`;
                    addSystemMessage(message);
                    break;
                case 'corner':
                    player.money += 200;
                    addSystemMessage(`ğŸ  ${player.name}ì´(ê°€) ì‹œì‘ì ì„ ì§€ë‚˜ $200ì„ ë°›ì•˜ìŠµë‹ˆë‹¤!`);
                    break;
            }
            
            // ëˆì´ ìŒìˆ˜ê°€ ë˜ì§€ ì•Šë„ë¡
            player.money = Math.max(0, player.money);
        }

        function resetGame() {
            boardGame.players.forEach(player => {
                player.position = 0;
                player.money = 1000;
            });
            boardGame.currentPlayer = 0;
            
            updatePlayerPositions();
            updatePlayerInfo();
            addSystemMessage('ğŸ² ê²Œì„ì´ ë¦¬ì…‹ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ë‹¤ë¥¸ ê²Œì„ë“¤
        function startQuiz() {
            const questions = [
                { q: "ìš°ë¦¬ ê°€ì¡±ì˜ ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ìŒì‹ì€?", a: ["í”¼ì", "ì¹˜í‚¨", "í•œì‹", "ì¤‘ì‹"] },
                { q: "ê°€ì¡± ì—¬í–‰ìœ¼ë¡œ ê°€ê³  ì‹¶ì€ ê³³ì€?", a: ["ë°”ë‹¤", "ì‚°", "ë„ì‹œ", "í•´ì™¸"] },
                { q: "ìš°ë¦¬ ê°€ì¡±ì˜ íŠ¹ë³„í•œ ë‚ ì€?", a: ["ìƒì¼", "ê¸°ë…ì¼", "ëª…ì ˆ", "íœ´ì¼"] },
                { q: "ê°€ì¡±ì´ í•¨ê»˜ ë³´ê³  ì‹¶ì€ ì˜í™” ì¥ë¥´ëŠ”?", a: ["ì½”ë¯¸ë””", "ì•¡ì…˜", "ë¡œë§¨ìŠ¤", "ì• ë‹ˆë©”ì´ì…˜"] }
            ];
            
            const randomQ = questions[Math.floor(Math.random() * questions.length)];
            const answer = prompt(`${randomQ.q}\n\nì„ íƒì§€: ${randomQ.a.join(', ')}`);
            
            if (answer) {
                addSystemMessage(`ğŸ§  ${currentUser.username}ë‹˜ì˜ í€´ì¦ˆ ë‹µë³€: "${answer}" - ì¢‹ì€ ë‹µë³€ì´ë„¤ìš”! ğŸ‰`);
            }
        }

        function startNumberGame() {
            const targetNumber = Math.floor(Math.random() * 100) + 1;
            let attempts = 0;
            let guess;
            
            addSystemMessage(`ğŸ² ${currentUser.username}ë‹˜ì´ ìˆ«ì ë§ì¶”ê¸° ê²Œì„ì„ ì‹œì‘í–ˆìŠµë‹ˆë‹¤! (1-100)`);
            
            do {
                guess = parseInt(prompt(`1-100 ì‚¬ì´ì˜ ìˆ«ìë¥¼ ë§ì¶°ë³´ì„¸ìš”! (ì‹œë„: ${attempts + 1})`));
                attempts++;
                
                if (guess < targetNumber) {
                    alert("ë” í° ìˆ«ìì…ë‹ˆë‹¤!");
                } else if (guess > targetNumber) {
                    alert("ë” ì‘ì€ ìˆ«ìì…ë‹ˆë‹¤!");
                } else {
                    addSystemMessage(`ğŸ‰ ${currentUser.username}ë‹˜ì´ ${targetNumber}ì„(ë¥¼) ${attempts}ë²ˆ ë§Œì— ë§ì·„ìŠµë‹ˆë‹¤!`);
                    break;
                }
            } while (attempts < 10 && guess !== targetNumber);
            
            if (guess !== targetNumber) {
                addSystemMessage(`ğŸ˜… ${currentUser.username}ë‹˜, ì•„ì‰½ë„¤ìš”! ì •ë‹µì€ ${targetNumber}ì´ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }

        function startMemoryGame() {
            showGameModal(`
                <h3>ğŸƒ ê¸°ì–µë ¥ ê²Œì„</h3>
                <p>ê°™ì€ ì´ëª¨ì§€ë¥¼ ì°¾ì•„ë³´ì„¸ìš”!</p>
                <div id="memoryBoard" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; max-width: 400px; margin: 20px auto;"></div>
                <div id="memoryScore">ì ìˆ˜: 0</div>
            `);
            
            const emojis = ['ğŸ¶', 'ğŸ±', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼', 'ğŸ¨', 'ğŸ¯'];
            const gameEmojis = [...emojis, ...emojis].sort(() => Math.random() - 0.5);
            let flippedCards = [];
            let matchedPairs = 0;
            let score = 0;
            
            const board = document.getElementById('memoryBoard');
            gameEmojis.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.style.cssText = `
                    width: 80px; height: 80px; background: #667eea; color: white;
                    display: flex; align-items: center; justify-content: center;
                    font-size: 24px; border-radius: 8px; cursor: pointer;
                    transition: all 0.3s;
                `;
                card.textContent = '?';
                card.onclick = () => flipCard(card, emoji, index);
                board.appendChild(card);
            });
            
            function flipCard(card, emoji, index) {
                if (card.classList.contains('flipped') || flippedCards.length === 2) return;
                
                card.classList.add('flipped');
                card.textContent = emoji;
                card.style.background = 'white';
                card.style.color = '#333';
                flippedCards.push({ card, emoji, index });
                
                if (flippedCards.length === 2) {
                    setTimeout(() => {
                        if (flippedCards[0].emoji === flippedCards[1].emoji) {
                            matchedPairs++;
                            score += 10;
                            if (matchedPairs === emojis.length) {
                                addSystemMessage(`ğŸ‰ ${currentUser.username}ë‹˜ì´ ê¸°ì–µë ¥ ê²Œì„ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ì ìˆ˜: ${score}`);
                            }
                        } else {
                            flippedCards.forEach(item => {
                                item.card.classList.remove('flipped');
                                item.card.textContent = '?';
                                item.card.style.background = '#667eea';
                                item.card.style.color = 'white';
                            });
                        }
                        flippedCards = [];
                        document.getElementById('memoryScore').textContent = `ì ìˆ˜: ${score}`;
                    }, 1000);
                }
            }
        }

        function startDrawingGame() {
            const words = ['ì§‘', 'ë‚˜ë¬´', 'ìë™ì°¨', 'ê³ ì–‘ì´', 'ê°•ì•„ì§€', 'ê½ƒ', 'íƒœì–‘', 'ë‹¬', 'ë³„', 'ë¬¼ê³ ê¸°'];
            const randomWord = words[Math.floor(Math.random() * words.length)];
            
            showGameModal(`
                <h3>ğŸ¨ ê·¸ë¦¼ ë§ì¶”ê¸°</h3>
                <p>ë‹¨ì–´: <strong>${randomWord}</strong></p>
                <canvas id="drawingCanvas" width="400" height="300" style="border: 2px solid #667eea; border-radius: 8px; background: white;"></canvas>
                <div style="margin: 20px 0;">
                    <button class="play-btn" onclick="clearCanvas()">ì§€ìš°ê¸°</button>
                    <button class="play-btn" onclick="saveDrawing()">ì™„ì„±!</button>
                    <input type="color" id="colorPicker" value="#000000">
                    <input type="range" id="brushSize" min="1" max="20" value="5">
                </div>
            `);
            
            const canvas = document.getElementById('drawingCanvas');
            const ctx = canvas.getContext('2d');
            let isDrawing = false;
            
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            
            function startDrawing(e) {
                isDrawing = true;
                draw(e);
            }
            
            function draw(e) {
                if (!isDrawing) return;
                
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                ctx.lineWidth = document.getElementById('brushSize').value;
                ctx.lineCap = 'round';
                ctx.strokeStyle = document.getElementById('colorPicker').value;
                
                ctx.lineTo(x, y);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(x, y);
            }
            
            function stopDrawing() {
                if (!isDrawing) return;
                isDrawing = false;
                ctx.beginPath();
            }
            
            window.clearCanvas = function() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            };
            
            window.saveDrawing = function() {
                const dataURL = canvas.toDataURL();
                addSystemMessage(`ğŸ¨ ${currentUser.username}ë‹˜ì´ "${randomWord}" ê·¸ë¦¼ì„ ì™„ì„±í–ˆìŠµë‹ˆë‹¤!`);
                
                // ê·¸ë¦¼ì„ ì±„íŒ…ì— ì´ë¯¸ì§€ë¡œ ì „ì†¡
                const drawingMessage = {
                    username: currentUser.username,
                    message: dataURL,
                    timestamp: new Date(),
                    familyCode: currentUser.familyCode,
                    type: 'image'
                };
                
                messages.push(drawingMessage);
                localStorage.setItem('familySiteMessages', JSON.stringify(messages));
                displayMessage(drawingMessage);
                
                closeModal();
            };
        }

        function startBingoGame() {
            showGameModal(`
                <h3>ğŸ¯ ë¹™ê³  ê²Œì„</h3>
                <div id="bingoBoard" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; max-width: 300px; margin: 20px auto;"></div>
                <div id="bingoInfo">ë¹™ê³  ì¤„ ìˆ˜: 0</div>
                <button class="play-btn" onclick="resetBingo()">ìƒˆ ê²Œì„</button>
            `);
            
            createBingoBoard();
        }

        function createBingoBoard() {
            const board = document.getElementById('bingoBoard');
            board.innerHTML = '';
            
            const numbers = Array.from({length: 25}, (_, i) => i + 1).sort(() => Math.random() - 0.5);
            
            numbers.forEach((num, index) => {
                const cell = document.createElement('div');
                cell.style.cssText = `
                    width: 50px; height: 50px; background: #f8f9fa; border: 2px solid #667eea;
                    display: flex; align-items: center; justify-content: center;
                    font-weight: bold; cursor: pointer; transition: all 0.3s;
                `;
                cell.textContent = num;
                cell.onclick = () => toggleBingoCell(cell);
                board.appendChild(cell);
            });
        }

        function toggleBingoCell(cell) {
            if (cell.style.background === 'rgb(102, 126, 234)') {
                cell.style.background = '#f8f9fa';
                cell.style.color = '#333';
            } else {
                cell.style.background = '#667eea';
                cell.style.color = 'white';
            }
            checkBingo();
        }

        function checkBingo() {
            const cells = document.querySelectorAll('#bingoBoard > div');
            const board = Array.from(cells).map(cell => cell.style.background === 'rgb(102, 126, 234)');
            let bingoCount = 0;
            
            // ê°€ë¡œ ì²´í¬
            for (let i = 0; i < 5; i++) {
                if (board.slice(i * 5, i * 5 + 5).every(cell => cell)) bingoCount++;
            }
            
            // ì„¸ë¡œ ì²´í¬
            for (let i = 0; i < 5; i++) {
                if ([0, 1, 2, 3, 4].every(j => board[i + j * 5])) bingoCount++;
            }
            
            // ëŒ€ê°ì„  ì²´í¬
            if ([0, 6, 12, 18, 24].every(i => board[i])) bingoCount++;
            if ([4, 8, 12, 16, 20].every(i => board[i])) bingoCount++;
            
            document.getElementById('bingoInfo').textContent = `ë¹™ê³  ì¤„ ìˆ˜: ${bingoCount}`;
            
            if (bingoCount >= 5) {
                addSystemMessage(`ğŸ¯ ${currentUser.username}ë‹˜ì´ ë¹™ê³ ë¥¼ ì™„ì„±í–ˆìŠµë‹ˆë‹¤! (${bingoCount}ì¤„)`);
            }
        }

        function resetBingo() {
            createBingoBoard();
            document.getElementById('bingoInfo').textContent = 'ë¹™ê³  ì¤„ ìˆ˜: 0';
        }

        function startRouletteGame() {
            const missions = [
                'ê°€ì¡±ì—ê²Œ ì‚¬ë‘í•œë‹¤ê³  ë§í•˜ê¸° ğŸ’•',
                'ì¬ë¯¸ìˆëŠ” ì¶¤ ì¶”ê¸° ğŸ’ƒ',
                'ì¢‹ì•„í•˜ëŠ” ë…¸ë˜ í•œ ì†Œì ˆ ë¶€ë¥´ê¸° ğŸµ',
                'ê°€ì¡± êµ¬ì„±ì› í•œ ëª… ì¹­ì°¬í•˜ê¸° ğŸ‘',
                'ì¬ë¯¸ìˆëŠ” ì´ì•¼ê¸° í•˜ë‚˜ ë“¤ë ¤ì£¼ê¸° ğŸ“š',
                'ì• êµ ë¶€ë¦¬ê¸° ğŸ˜Š',
                'ê°€ì¡±ê³¼ í•¨ê»˜ ì…€ì¹´ ì°ê¸° ğŸ“¸',
                'ì¢‹ì•„í•˜ëŠ” ìŒì‹ ì†Œê°œí•˜ê¸° ğŸ•',
                'ê°„ë‹¨í•œ ë§ˆìˆ  ë³´ì—¬ì£¼ê¸° ğŸ©',
                'ê°€ì¡±ì—ê²Œ ê°ì‚¬ ì¸ì‚¬í•˜ê¸° ğŸ™'
            ];
            
            showGameModal(`
                <h3>ğŸª ê°€ì¡± ë£°ë ›</h3>
                <div id="roulette" style="width: 200px; height: 200px; border: 5px solid #667eea; border-radius: 50%; margin: 20px auto; position: relative; background: conic-gradient(#ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #ffeaa7, #dda0dd, #98d8c8, #f7dc6f, #bb8fce, #85c1e9);">
                    <div id="roulettePointer" style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-bottom: 20px solid #333;"></div>
                    <div id="rouletteCenter" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; height: 40px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">GO</div>
                </div>
                <button class="play-btn" onclick="spinRoulette()">ë£°ë › ëŒë¦¬ê¸°!</button>
                <div id="missionResult" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; display: none;"></div>
            `);
            
            window.spinRoulette = function() {
                const roulette = document.getElementById('roulette');
                const randomDegree = Math.floor(Math.random() * 360) + 1440; // ìµœì†Œ 4ë°”í€´
                
                roulette.style.transition = 'transform 3s ease-out';
                roulette.style.transform = `rotate(${randomDegree}deg)`;
                
                setTimeout(() => {
                    const missionIndex = Math.floor(Math.random() * missions.length);
                    const mission = missions[missionIndex];
                    
                    const result = document.getElementById('missionResult');
                    result.innerHTML = `
                        <h4>ğŸ¯ ë¯¸ì…˜!</h4>
                        <p>${mission}</p>
                        <button class="play-btn" onclick="completeMission('${mission}')">ë¯¸ì…˜ ì™„ë£Œ!</button>
                    `;
                    result.style.display = 'block';
                }, 3000);
            };
            
            window.completeMission = function(mission) {
                addSystemMessage(`ğŸª ${currentUser.username}ë‹˜ì´ ë¯¸ì…˜ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤: ${mission}`);
                closeModal();
            };
        }

        // ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜
        function showGameModal(content) {
            const modal = document.getElementById('gameModal');
            const gameContent = document.getElementById('gameContent');
            gameContent.innerHTML = content;
            modal.classList.add('show');
        }

        function closeModal() {
            const modal = document.getElementById('gameModal');
            modal.classList.remove('show');
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ë¡œê·¸ì¸ í™•ì¸
        window.onload = function() {
            const savedUser = localStorage.getItem('familySiteUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                document.getElementById('auth-container').classList.add('hidden');
                document.getElementById('main-container').classList.remove('hidden');
                document.getElementById('welcomeMessage').textContent = `ì•ˆë…•í•˜ì„¸ìš”, ${currentUser.username}ë‹˜!`;
                
                addOnlineUser(currentUser);
                loadMessages();
                loadPhotos();
                initBoardGame();
            }
        };

        // í˜ì´ì§€ ì¢…ë£Œ ì‹œ ì •ë¦¬
        window.onbeforeunload = function() {
            if (currentUser) {
                removeOnlineUser(currentUser);
            }
        };
    </script>
</body>
</html>